{
	"$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"nicName": {
			"type": "string"
		},
		"subnetRef": {
			"type": "string"
		},
		"privateIp": {
			"type": "string"
		},
		"publicIpName": {
			"type": "string"
		},
		"lbName": {
			"type": "string"
		},
		"lbBackendPoolName": {
			"type": "string"
		},
		"internalLBResourceGroup": {
			"type": "string"
		}
	},
	"variables": {
		"internalLbId": "[resourceId(parameters('internalLBResourceGroup'),concat('Microsoft.Network','/','loadBalancers'),parameters('lbName'))]",
	},
	"resources": [{
			"apiVersion": "2017-05-10",
			"name": "[parameters('nicName')]",
			"type": "Microsoft.Resources/deployments",
			"resourceGroup": "[parameters('internalLBResourceGroup')]",
			"properties": {
				"template": {
					"$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
					"contentVersion": "1.0.0.0",
					"parameters": {},
					"variables": {},
					"resources": [{
							"type": "Microsoft.Network/networkInterfaces",
							"name": "[parameters('nicName')]",
							"apiVersion": "2015-06-15",
							"location": "East US",
							"properties": {
								 "mode": "Incremental",
								"ipConfigurations": [{
										"name": "ipconfig1",
										"properties": {
											"privateIPAllocationMethod": "Static",
											"privateIPAddress": "[parameters('privateIp')]",
											"subnet": {
												"id": "[parameters('subnetRef')]"
											},
											"loadBalancerBackendAddressPools": [{
													"id": "[concat(variables('internalLbId'),'/backendAddressPools/', parameters('lbBackendPoolName'))]"
												}
											]
										}
									}
								]
							}
						}
					]
				}
			}
		}
	]
}
